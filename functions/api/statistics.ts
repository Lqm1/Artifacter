import { API_VER } from '../../src/components/api-statistics'
import type { Statistics } from '../../src/components/api-statistics-types'
import { resStatus } from '../utils'

// Cloudflare Cache Rule を利用

type Env = {
  statistics: D1Database
}

const TABLE = 'statistics'
const COMP_UID = 1

export const onRequestGet: PagesFunction<Env> = async ctx => {
  if (ctx.request.headers.get('sec-fetch-site') !== 'same-origin') return resStatus(403)

  //********** set test data **********
  //await setStat(ctx.env.statistics, COMP_UID, Date.now(), statString)

  //********** get data **********
  const data = await ctx.env.statistics
    .prepare(`SELECT uid, data FROM ${TABLE} WHERE uid=${COMP_UID}`)
    .first<{ uid: number; data: string }>()
  if (!data?.data) throw new Error('No statistics value')
  const json = JSON.parse(data.data) as Statistics
  return new Response(JSON.stringify({ ...json, ver: API_VER } as Statistics), {
    headers: { 'Content-Type': 'application/json' },
  })
}

//********** set test data **********
const setStat = (db: D1Database, uid: number, updated_at: number, data: string) =>
  db.prepare(`REPLACE INTO ${TABLE} (uid, updated_at, data) VALUES(?, ?, ?)`).bind(uid, updated_at, data).all()
const statString =
  '{"playerInfo":{"count":2,"level":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],"finishAchievementNum":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],"finishAchievementNum100":[0,0,0,0,0,0,0,1,0,0,0,0,0,1],"finishAchievementNumTop":1328,"fetterCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],"towerFloorIndex":[0,0,0,0,0,0,0,0,0,0,0,0,2],"theaterActIndex":[0,0,0,0,0,0,0,0,0,0,2]},"avatarInfoList":[{"avatarId":10000002,"count":1,"consts":[1,0,0,0,0,0,0],"stats":[{"fightProp":2000,"value":{"mean":17757.248046875,"median":17757.248046875}},{"fightProp":2001,"value":{"mean":2439.55810546875,"median":2439.55810546875}},{"fightProp":2002,"value":{"mean":882.035888671875,"median":882.035888671875}},{"fightProp":28,"value":{"mean":0,"median":0}},{"fightProp":20,"value":{"mean":0.6176000237464905,"median":0.6176000237464905}},{"fightProp":22,"value":{"mean":2.1255240440368652,"median":2.1255240440368652}},{"fightProp":23,"value":{"mean":1.3562999963760376,"median":1.3562999963760376}},{"value":{"mean":0.7359999966621399,"median":0.7359999966621399}}],"weapon":[{"id":11509,"count":1}],"reliquarySet":[{"set":[{"id":14001,"piece":4}],"count":1}],"skills":[{"id":10013,"mean":1,"median":1,"mode":1},{"id":10018,"mean":10,"median":10,"mode":10},{"id":10019,"mean":10,"median":10,"mode":10},{"id":10024,"mean":10,"median":10,"mode":10}]},{"avatarId":10000023,"count":1,"consts":[0,0,0,0,0,1,0],"stats":[{"fightProp":2000,"value":{"mean":17446.32421875,"median":17446.32421875}},{"fightProp":2001,"value":{"mean":1444.900146484375,"median":1444.900146484375}},{"fightProp":2002,"value":{"mean":668.87109375,"median":668.87109375}},{"fightProp":28,"value":{"mean":305.80999755859375,"median":305.80999755859375}},{"fightProp":20,"value":{"mean":0.628212034702301,"median":0.628212034702301}},{"fightProp":22,"value":{"mean":1.4562000036239624,"median":1.4562000036239624}},{"fightProp":23,"value":{"mean":2.0225000381469727,"median":2.0225000381469727}},{"value":{"mean":0.4659999907016754,"median":0.4659999907016754}}],"weapon":[{"id":13505,"count":1}],"reliquarySet":[{"set":[{"id":15020,"piece":4}],"count":1}],"skills":[{"id":10231,"mean":6,"median":6,"mode":6},{"id":10232,"mean":6,"median":6,"mode":6},{"id":10235,"mean":8,"median":8,"mode":8}]},{"avatarId":10000025,"count":1,"consts":[0,0,0,0,0,0,1],"stats":[{"fightProp":2000,"value":{"mean":15002.419921875,"median":15002.419921875}},{"fightProp":2001,"value":{"mean":1662.9888916015625,"median":1662.9888916015625}},{"fightProp":2002,"value":{"mean":780.7489013671875,"median":780.7489013671875}},{"fightProp":28,"value":{"mean":46.619998931884766,"median":46.619998931884766}},{"fightProp":20,"value":{"mean":0.5982000231742859,"median":0.5982000231742859}},{"fightProp":22,"value":{"mean":1.4868000745773315,"median":1.4868000745773315}},{"fightProp":23,"value":{"mean":2.1688318252563477,"median":2.1688318252563477}},{"value":{"mean":0.6660000085830688,"median":0.6660000085830688}}],"weapon":[{"id":11403,"count":1}],"reliquarySet":[{"set":[{"id":15020,"piece":4}],"count":1}],"skills":[{"id":10381,"mean":9,"median":9,"mode":9},{"id":10382,"mean":9,"median":9,"mode":9},{"id":10385,"mean":9,"median":9,"mode":9}]},{"avatarId":10000032,"count":1,"consts":[0,0,0,0,0,0,1],"stats":[{"fightProp":2000,"value":{"mean":23880.734375,"median":23880.734375}},{"fightProp":2001,"value":{"mean":1459.3980712890625,"median":1459.3980712890625}},{"fightProp":2002,"value":{"mean":833.7493286132812,"median":833.7493286132812}},{"fightProp":28,"value":{"mean":93.25,"median":93.25}},{"fightProp":20,"value":{"mean":0.38440001010894775,"median":0.38440001010894775}},{"fightProp":22,"value":{"mean":0.8884999752044678,"median":0.8884999752044678}},{"fightProp":23,"value":{"mean":2.115000009536743,"median":2.115000009536743}},{"value":{"mean":0.37710002064704895,"median":0.37710002064704895}}],"weapon":[{"id":11501,"count":1}],"reliquarySet":[{"set":[{"id":15007,"piece":4}],"count":1}],"skills":[{"id":10321,"mean":6,"median":6,"mode":6},{"id":10322,"mean":6,"median":6,"mode":6},{"id":10323,"mean":8,"median":8,"mode":8}]},{"avatarId":10000037,"count":1,"consts":[0,1,0,0,0,0,0],"stats":[{"fightProp":2000,"value":{"mean":14956.2197265625,"median":14956.2197265625}},{"fightProp":2001,"value":{"mean":2446.380615234375,"median":2446.380615234375}},{"fightProp":2002,"value":{"mean":665.1491088867188,"median":665.1491088867188}},{"fightProp":28,"value":{"mean":80,"median":80}},{"fightProp":20,"value":{"mean":0.5011000037193298,"median":0.5011000037193298}},{"fightProp":22,"value":{"mean":2.1819000244140625,"median":2.1819000244140625}},{"fightProp":23,"value":{"mean":1.3432999849319458,"median":1.3432999849319458}},{"value":{"mean":0.4659999907016754,"median":0.4659999907016754}}],"weapon":[{"id":15502,"count":1}],"reliquarySet":[{"set":[{"id":15003,"piece":4}],"count":1}],"skills":[{"id":10371,"mean":10,"median":10,"mode":10},{"id":10372,"mean":10,"median":10,"mode":10},{"id":10373,"mean":10,"median":10,"mode":10}]},{"avatarId":10000051,"count":1,"consts":[0,1,0,0,0,0,0],"stats":[{"fightProp":2000,"value":{"mean":21204.03125,"median":21204.03125}},{"fightProp":2001,"value":{"mean":2242.45361328125,"median":2242.45361328125}},{"fightProp":2002,"value":{"mean":789.0862426757812,"median":789.0862426757812}},{"fightProp":28,"value":{"mean":20.979999542236328,"median":20.979999542236328}},{"fightProp":20,"value":{"mean":0.6487999558448792,"median":0.6487999558448792}},{"fightProp":22,"value":{"mean":1.8399999141693115,"median":1.8399999141693115}},{"fightProp":23,"value":{"mean":1.582800030708313,"median":1.582800030708313}},{"value":{"mean":1.0829999446868896,"median":1.0829999446868896}}],"weapon":[{"id":12502,"count":1}],"reliquarySet":[{"set":[{"id":15008,"piece":2},{"id":15018,"piece":2}],"count":1}],"skills":[{"id":10511,"mean":10,"median":10,"mode":10},{"id":10512,"mean":10,"median":10,"mode":10},{"id":10515,"mean":10,"median":10,"mode":10}]},{"avatarId":10000052,"count":2,"consts":[1,0,0,1,0,0,0],"stats":[{"fightProp":2000,"value":{"mean":18749.341796875,"median":18749.341796875}},{"fightProp":2001,"value":{"mean":2036.8564842649812,"median":2036.8564842649812}},{"fightProp":2002,"value":{"mean":814.7676391601562,"median":814.7676391601562}},{"fightProp":28,"value":{"mean":71.0999984741211,"median":71.0999984741211}},{"fightProp":20,"value":{"mean":0.5788500159978867,"median":0.5788500159978867}},{"fightProp":22,"value":{"mean":1.5530499815940857,"median":1.5530499815940857}},{"fightProp":23,"value":{"mean":2.7700400352478027,"median":2.7700400352478027}},{"value":{"mean":0.7080160140991212,"median":0.7080160140991212}}],"weapon":[{"id":13415,"count":1},{"id":13509,"count":1}],"reliquarySet":[{"set":[{"id":15020,"piece":4}],"count":2}],"skills":[{"id":10521,"mean":7,"median":7,"mode":4},{"id":10522,"mean":8,"median":8,"mode":6},{"id":10525,"mean":9.5,"median":9.5,"mode":9}]},{"avatarId":10000060,"count":2,"consts":[1,1,0,0,0,0,0],"stats":[{"fightProp":2000,"value":{"mean":33713.912109375,"median":33713.912109375}},{"fightProp":2001,"value":{"mean":1119.8377075195312,"median":1119.8377075195312}},{"fightProp":2002,"value":{"mean":634.8108215332031,"median":634.8108215332031}},{"fightProp":28,"value":{"mean":44.29500198364258,"median":44.29500198364258}},{"fightProp":20,"value":{"mean":0.753250002861023,"median":0.753250002861023}},{"fightProp":22,"value":{"mean":1.7336241006851196,"median":1.7336241006851196}},{"fightProp":23,"value":{"mean":1.7653658986091614,"median":1.7653658986091614}},{"value":{"mean":0.4659999907016754,"median":0.4659999907016754}}],"weapon":[{"id":15401,"count":1},{"id":15508,"count":1}],"reliquarySet":[{"set":[{"id":15020,"piece":4}],"count":2}],"skills":[{"id":10606,"mean":8.5,"median":8.5,"mode":7},{"id":10607,"mean":9,"median":9,"mode":8},{"id":10610,"mean":9.5,"median":9.5,"mode":9}]},{"avatarId":10000063,"count":1,"consts":[1,0,0,0,0,0,0],"stats":[{"fightProp":2000,"value":{"mean":20372.0390625,"median":20372.0390625}},{"fightProp":2001,"value":{"mean":3640.5380859375,"median":3640.5380859375}},{"fightProp":2002,"value":{"mean":923.1954956054688,"median":923.1954956054688}},{"fightProp":28,"value":{"mean":0,"median":0}},{"fightProp":20,"value":{"mean":0.12780000269412994,"median":0.12780000269412994}},{"fightProp":22,"value":{"mean":0.6243000030517578,"median":0.6243000030517578}},{"fightProp":23,"value":{"mean":1.8680000305175781,"median":1.8680000305175781}},{"value":{"mean":0,"median":0}}],"weapon":[{"id":13406,"count":1}],"reliquarySet":[{"set":[{"id":15001,"piece":2},{"id":15019,"piece":2}],"count":1}],"skills":[{"id":10631,"mean":6,"median":6,"mode":6},{"id":10632,"mean":10,"median":10,"mode":10},{"id":10635,"mean":9,"median":9,"mode":9}]},{"avatarId":10000065,"count":1,"consts":[0,0,0,0,0,0,1],"stats":[{"fightProp":2000,"value":{"mean":24310.25390625,"median":24310.25390625}},{"fightProp":2001,"value":{"mean":1435.813232421875,"median":1435.813232421875}},{"fightProp":2002,"value":{"mean":1153.156982421875,"median":1153.156982421875}},{"fightProp":28,"value":{"mean":907.4539794921875,"median":907.4539794921875}},{"fightProp":20,"value":{"mean":0.05000000074505806,"median":0.05000000074505806}},{"fightProp":22,"value":{"mean":0.7875000238418579,"median":0.7875000238418579}},{"fightProp":23,"value":{"mean":1.0648000240325928,"median":1.0648000240325928}},{"value":{"mean":0,"median":0}}],"weapon":[{"id":11407,"count":1}],"reliquarySet":[{"set":[{"id":15026,"piece":4}],"count":1}],"skills":[{"id":10651,"mean":7,"median":7,"mode":7},{"id":10652,"mean":8,"median":8,"mode":8},{"id":10655,"mean":8,"median":8,"mode":8}]},{"avatarId":10000070,"count":1,"consts":[1,0,0,0,0,0,0],"stats":[{"fightProp":2000,"value":{"mean":52823.7421875,"median":52823.7421875}},{"fightProp":2001,"value":{"mean":1174.2254638671875,"median":1174.2254638671875}},{"fightProp":2002,"value":{"mean":723.48486328125,"median":723.48486328125}},{"fightProp":28,"value":{"mean":406.2340087890625,"median":406.2340087890625}},{"fightProp":20,"value":{"mean":0.3766000270843506,"median":0.3766000270843506}},{"fightProp":22,"value":{"mean":1.0750999450683594,"median":1.0750999450683594}},{"fightProp":23,"value":{"mean":1.4095053714752197,"median":1.4095053714752197}},{"value":{"mean":0,"median":0}}],"weapon":[{"id":11418,"count":1}],"reliquarySet":[{"set":[{"id":15017,"piece":2},{"id":15026,"piece":2}],"count":1}],"skills":[{"id":10701,"mean":9,"median":9,"mode":9},{"id":10702,"mean":9,"median":9,"mode":9},{"id":10705,"mean":9,"median":9,"mode":9}]},{"avatarId":10000073,"count":2,"consts":[1,1,0,0,0,0,0],"stats":[{"fightProp":2000,"value":{"mean":17939.5908203125,"median":17939.5908203125}},{"fightProp":2001,"value":{"mean":1310.6356811523438,"median":1310.6356811523438}},{"fightProp":2002,"value":{"mean":664.7483825683594,"median":664.7483825683594}},{"fightProp":28,"value":{"mean":743.5782165527344,"median":743.5782165527344}},{"fightProp":20,"value":{"mean":0.3260999992489815,"median":0.3260999992489815}},{"fightProp":22,"value":{"mean":1.8874499797821045,"median":1.8874499797821045}},{"fightProp":23,"value":{"mean":1.1133500337600708,"median":1.1133500337600708}},{"value":{"mean":0.3830000013113022,"median":0.3830000013113022}}],"weapon":[{"id":14403,"count":1},{"id":14511,"count":1}],"reliquarySet":[{"set":[{"id":15025,"piece":4}],"count":2}],"skills":[{"id":10731,"mean":9.5,"median":9.5,"mode":9},{"id":10732,"mean":9.5,"median":9.5,"mode":9},{"id":10735,"mean":9,"median":9,"mode":8}]},{"avatarId":10000078,"count":1,"consts":[1,0,0,0,0,0,0],"stats":[{"fightProp":2000,"value":{"mean":19562.052734375,"median":19562.052734375}},{"fightProp":2001,"value":{"mean":1384.248291015625,"median":1384.248291015625}},{"fightProp":2002,"value":{"mean":969.6499633789062,"median":969.6499633789062}},{"fightProp":28,"value":{"mean":338.77001953125,"median":338.77001953125}},{"fightProp":20,"value":{"mean":0.5710000395774841,"median":0.5710000395774841}},{"fightProp":22,"value":{"mean":1.700524091720581,"median":1.700524091720581}},{"fightProp":23,"value":{"mean":1.284999966621399,"median":1.284999966621399}},{"value":{"mean":0.7539999485015869,"median":0.7539999485015869}}],"weapon":[{"id":11515,"count":1}],"reliquarySet":[{"set":[{"id":15026,"piece":4}],"count":1}],"skills":[{"id":10781,"mean":9,"median":9,"mode":9},{"id":10782,"mean":9,"median":9,"mode":9},{"id":10785,"mean":9,"median":9,"mode":9}]},{"avatarId":10000089,"count":1,"consts":[0,0,1,0,0,0,0],"stats":[{"fightProp":2000,"value":{"mean":34741.82421875,"median":34741.82421875}},{"fightProp":2001,"value":{"mean":1564.5043076171876,"median":1564.5043076171876}},{"fightProp":2002,"value":{"mean":886.95654296875,"median":886.95654296875}},{"fightProp":28,"value":{"mean":39.62999725341797,"median":39.62999725341797}},{"fightProp":20,"value":{"mean":1.0174239873886108,"median":1.0174239873886108}},{"fightProp":22,"value":{"mean":2.0000998973846436,"median":2.0000998973846436}},{"fightProp":23,"value":{"mean":1.679900050163269,"median":1.679900050163269}},{"value":{"mean":0,"median":0}}],"weapon":[{"id":11505,"count":1}],"reliquarySet":[{"set":[{"id":15032,"piece":4}],"count":1}],"skills":[{"id":10891,"mean":9,"median":9,"mode":9},{"id":10892,"mean":10,"median":10,"mode":10},{"id":10895,"mean":10,"median":10,"mode":10}]},{"avatarId":10000096,"count":1,"consts":[1,0,0,0,0,0,0],"stats":[{"fightProp":2000,"value":{"mean":22213.869140625,"median":22213.869140625}},{"fightProp":2001,"value":{"mean":2647.831802734375,"median":2647.831802734375}},{"fightProp":2002,"value":{"mean":827.6875,"median":827.6875}},{"fightProp":28,"value":{"mean":16.31999969482422,"median":16.31999969482422}},{"fightProp":20,"value":{"mean":0.7343000173568726,"median":0.7343000173568726}},{"fightProp":22,"value":{"mean":2.2293360233306885,"median":2.2293360233306885}},{"fightProp":23,"value":{"mean":1.0583000183105469,"median":1.0583000183105469}},{"value":{"mean":0.4659999907016754,"median":0.4659999907016754}}],"weapon":[{"id":13501,"count":1}],"reliquarySet":[{"set":[{"id":15001,"piece":4}],"count":1}],"skills":[{"id":10961,"mean":10,"median":10,"mode":10},{"id":10962,"mean":8,"median":8,"mode":8},{"id":10965,"mean":10,"median":10,"mode":10}]},{"avatarId":10000098,"count":1,"consts":[0,1,0,0,0,0,0],"stats":[{"fightProp":2000,"value":{"mean":19652.37109375,"median":19652.37109375}},{"fightProp":2001,"value":{"mean":2289.865234375,"median":2289.865234375}},{"fightProp":2002,"value":{"mean":843.2431030273438,"median":843.2431030273438}},{"fightProp":28,"value":{"mean":67.5999984741211,"median":67.5999984741211}},{"fightProp":20,"value":{"mean":0.6775000095367432,"median":0.6775000095367432}},{"fightProp":22,"value":{"mean":2.4857239723205566,"median":2.4857239723205566}},{"fightProp":23,"value":{"mean":1,"median":1}},{"value":{"mean":0.4659999907016754,"median":0.4659999907016754}}],"weapon":[{"id":11515,"count":1}],"reliquarySet":[{"set":[{"id":15035,"piece":4}],"count":1}],"skills":[{"id":10981,"mean":10,"median":10,"mode":10},{"id":10982,"mean":10,"median":10,"mode":10},{"id":10985,"mean":10,"median":10,"mode":10}]}],"timestamp":1732312827360}'
